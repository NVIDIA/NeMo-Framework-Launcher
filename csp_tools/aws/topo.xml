<!--
Copyright (c) 2023, NVIDIA CORPORATION.  All rights reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<!--
Copyright (c) 2023, Amazon.com, Inc. or its affiliates. All rights reserved.
See LICENSE.txt for license information

Static pre-configured topology for `p5.48xlarge` platform type.
This has 4 groups of PCIe hierarchy under each socket. Each group has
1 GPUs and 4 NIC behind a PCIe switch. GPUs are not reported in this file.

This topology is ingested into NCCL using `NCCL_TOPO_FILE` environment
variable when the underlying system is detected as `p5.48xlarge`.

Note: The PCI IDs of PCI switches and NICs needs to match the PCI IDs on the
virtual machine.
-->
<system version="1">
  <cpu numaid="0">
    <pci busid="0000:45:00.0">
      <pci busid="0000:4f:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:50:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:51:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:52:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
    </pci>
    <pci busid="0000:56:00.0">
      <pci busid="0000:60:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:61:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:62:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:63:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
    </pci>
    <pci busid="0000:67:00.0">
      <pci busid="0000:71:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:72:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:73:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:74:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
    </pci>
    <pci busid="0000:78:00.0">
      <pci busid="0000:82:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:83:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:84:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:85:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
    </pci>
  </cpu>
  <cpu numaid="1">
    <pci busid="0000:89:00.0">
      <pci busid="0000:93:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:94:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:95:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:96:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
    </pci>
    <pci busid="0000:9a:00.0">
      <pci busid="0000:a4:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:a5:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:a6:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:a7:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
    </pci>
    <pci busid="0000:ab:00.0">
      <pci busid="0000:b5:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:b6:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:b7:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:b8:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
    </pci>
    <pci busid="0000:bc:00.0">
      <pci busid="0000:c6:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:c7:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:c8:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
      <pci busid="0000:c9:00.0" link_speed="32 GT/s PCIe/s" link_width="16"/>
    </pci>
  </cpu>
</system>